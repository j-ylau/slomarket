(()=>{var e={};e.id=3237,e.ids=[3237],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},50852:e=>{"use strict";e.exports=require("async_hooks")},14300:e=>{"use strict";e.exports=require("buffer")},96206:e=>{"use strict";e.exports=require("console")},6113:e=>{"use strict";e.exports=require("crypto")},67643:e=>{"use strict";e.exports=require("diagnostics_channel")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},15673:e=>{"use strict";e.exports=require("node:events")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},77282:e=>{"use strict";e.exports=require("process")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},35356:e=>{"use strict";e.exports=require("stream/web")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},29830:e=>{"use strict";e.exports=require("util/types")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},14443:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>d,originalPathname:()=>p,pages:()=>l,routeModule:()=>x,tree:()=>c});var s=r(67096),i=r(16132),n=r(37284),a=r.n(n),o=r(32564),u={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(u[e]=()=>o[e]);r.d(t,u);let c=["",{children:["edit-listing",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,91322)),"/Users/jlau/Code-2023/cpmarketplace/src/app/edit-listing/[id]/page.js"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,96109)),"/Users/jlau/Code-2023/cpmarketplace/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/Users/jlau/Code-2023/cpmarketplace/src/app/edit-listing/[id]/page.js"],p="/edit-listing/[id]/page",d={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/edit-listing/[id]/page",pathname:"/edit-listing/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},64897:(e,t,r)=>{Promise.resolve().then(r.bind(r,18457))},18457:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>EditListing});var s=r(30784),i=r(57114),n=r(9885),a=r(61522),o=r(76151),u=r(18282),c=r(21971),l=r.n(c),p=r(92870),d=r.n(p),x=r(16614),g=r.n(x);function EditListing(){let e=(0,i.useRouter)(),{id:t}=(0,i.useParams)(),{getUser:r,isAuthenticated:c}=(0,u.useAuth)(),[p,x]=(0,n.useState)(null),[m,q]=(0,n.useState)({open:!1,message:""}),[h,f]=(0,n.useState)(""),[_,y]=(0,n.useState)(""),[v,b]=(0,n.useState)([]),[j,P]=(0,n.useState)(!1),[w,k]=(0,n.useState)(!1),[L,S]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let fetchListing=async()=>{if(!t)return;let e=(0,a.JU)(o.db,"listings",t),r=await (0,a.QT)(e);if(r.exists()){let e=r.data();x({title:e.title,description:e.description,price:e.price,location:e.location,category:e.category}),f(e.location),y(e.category)}else console.error("No such listing!");S(!1)};fetchListing()},[t]);let handleSubmit=async()=>{let r=validateForm();if(r){q({open:!0,message:r});return}k(!0);try{let r=(0,a.JU)(o.db,"listings",t);await (0,a.r7)(r,{...p,location:h,category:_,updatedAt:n.Timestamp.fromDate(new Date)}),q({open:!0,message:"Listing updated successfully!"}),k(!1),e.push(`/listing/${t}`)}catch(e){console.error(e),q({open:!0,message:e.message}),k(!1)}};(0,n.useCallback)(e=>{setListingImage(t=>[...t,...e.map(e=>({file:e,preview:URL.createObjectURL(e)}))])},[]);let validateForm=()=>p.title.trim()?p.description.trim()?null==p.price?"Price is required.":p.price<0?"Price cannot be negative.":/^\d+(\.\d{0,2})?$/.test(p.price.toString())?p.location?0===listingImage.length?"At least one image is required.":"":"Location is required.":"Price must not exceed two decimal places.":"Description is required.":"Title is required.";return L?s.jsx("div",{children:"Loading..."}):p?s.jsx(l(),{container:!0,justifyContent:"center",alignItems:"center",style:{padding:"40px"},children:s.jsx(l(),{item:!0,xs:12,md:8,lg:6,children:(0,s.jsxs)("form",{onSubmit:handleSubmit,style:{display:"flex",flexDirection:"column"},children:[s.jsx(d(),{autoFocus:!0,margin:"dense",id:"title",name:"title",label:"Listing Title",type:"text",variant:"outlined",value:p.title,onChange:e=>{let{name:t,value:r}=e.target;x({...p,[t]:r})},required:!0}),s.jsx(g(),{type:"submit",color:"primary",variant:"contained",disabled:w,children:w?"Updating...":"Update Listing"})]})})}):s.jsx("div",{children:"Listing not found or you do not have permission to edit it."})}r(96106),r(52451)},91322:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>n,default:()=>u});var s=r(95153);let i=(0,s.createProxy)(String.raw`/Users/jlau/Code-2023/cpmarketplace/src/app/edit-listing/[id]/page.js`),{__esModule:n,$$typeof:a}=i,o=i.default,u=o}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[657,6120,8153,1323,4359,2870,2451,402,2291],()=>__webpack_exec__(14443));module.exports=r})();