(()=>{var e={};e.id=6495,e.ids=[6495],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},50852:e=>{"use strict";e.exports=require("async_hooks")},14300:e=>{"use strict";e.exports=require("buffer")},96206:e=>{"use strict";e.exports=require("console")},6113:e=>{"use strict";e.exports=require("crypto")},67643:e=>{"use strict";e.exports=require("diagnostics_channel")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},15673:e=>{"use strict";e.exports=require("node:events")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},77282:e=>{"use strict";e.exports=require("process")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},35356:e=>{"use strict";e.exports=require("stream/web")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},29830:e=>{"use strict";e.exports=require("util/types")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},66662:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=s(67096),n=s(16132),i=s(37284),a=s.n(i),l=s(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["profile",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,93222)),"/Users/jlau/Code-2023/cpmarketplace/src/app/profile/[id]/page.js"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,96109)),"/Users/jlau/Code-2023/cpmarketplace/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/jlau/Code-2023/cpmarketplace/src/app/profile/[id]/page.js"],u="/profile/[id]/page",h={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/profile/[id]/page",pathname:"/profile/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},77008:(e,t,s)=>{Promise.resolve().then(s.bind(s,5760))},5760:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>Profile});var r=s(30784),n=s(9885),i=s(33987),a=s.n(i),l=s(43872),o=s.n(l),c=s(81932),d=s.n(c),u=s(99360),h=s.n(u),p=s(21971),x=s.n(p),g=s(95843),m=s.n(g),j=s(11666),f=s.n(j),b=s(16854),y=s(48060),v=s.n(y),S=s(71829),w=s.n(S),C=s(88707),P=s.n(C),k=s(61272),A=s.n(k),I=s(87726),q=s.n(I),L=s(307),D=s.n(L),_=s(57114),U=s(18282),N=s(39358),E=s(96106),R=s(29300),J=s(39223),F=s(30237),T=s(69700),V=s(8349),O=s(53531),Z=s.n(O),$=s(70436),M=s(61522),B=s(76151);function MyListings({user:e}){let[t,s]=(0,n.useState)([]),[i,l]=(0,n.useState)(1);return(0,n.useEffect)(()=>{let fetchListings=async()=>{let t=(0,M.IO)((0,M.hJ)(B.db,"listings"),(0,M.ar)("sellerId","==",e.uid),(0,M.Xo)("createdAt","desc")),r=await (0,M.PL)(t),n=[];r.forEach(e=>{n.push({id:e.id,...e.data()})}),s(n)};fetchListings()},[]),r.jsx(o(),{px:3,py:2,children:0===t.length?(0,r.jsxs)(o(),{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pb:10,children:[r.jsx("img",{src:"/_next/static/fonts/standing-19.svg",alt:"No Listings"}),(0,r.jsxs)(a(),{pt:5,variant:"h5",children:[(0,r.jsxs)("strong",{children:["No listings found by ",e.name]})," "]})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(x(),{container:!0,spacing:2,children:t.slice((i-1)*5,5*i).map(e=>{let t=e.location.split(", "),s=t.length>2?`${t[1]}, ${t[2]}`:e.location;return r.jsx(x(),{item:!0,children:r.jsx($.Z,{listingId:e.id,title:e.title,createdAt:e.createdAt,updatedAt:e.updatedAt,description:e.description,images:e.images,location:s,price:e.price,studentVerification:e.studentVerification,priceHistory:e.priceHistory})},e.id)})}),r.jsx(b.default,{spacing:2,alignItems:"center",marginY:5,children:r.jsx(Z(),{count:Math.ceil(t.length/5),page:i,onChange:(e,t)=>{l(t)}})})]})})}var W=s(52694),H=s.n(W),z=s(92870),Y=s.n(z),G=s(26017),X=s.n(G),Q=s(49696),K=s.n(Q),ee=s(16614),et=s.n(ee),es=s(62969),er=s.n(es),en=s(16856),ei=s.n(en),ea=s(42153),el=s.n(ea),eo=s(95915),ec=s.n(eo),ed=s(96686),eu=s(64622);function Settings({user:e,setUser:t,setCurrentTab:s}){let[i,l]=(0,n.useState)({}),[c,u]=(0,n.useState)(),[h,p]=(0,n.useState)([]),[g,j]=(0,n.useState)([]),[f,b]=(0,n.useState)(!1),[y,S]=(0,n.useState)(!1),w=(0,_.useRouter)(),{getUser:C}=(0,U.useAuth)(),[P,k]=(0,n.useState)(null),handleChange1=e=>{k(e.target.value)},[A,I]=(0,n.useState)(null),handleChange2=e=>{I(e.target.value)},[q,L]=(0,n.useState)(null),handleChange3=e=>{L(e.target.value)},D=(0,n.useCallback)(e=>{let t=e[0],s=URL.createObjectURL(t);p([t,s]),b(!1)},[]),J=(0,n.useCallback)(e=>{let t=e[0],s=URL.createObjectURL(t);j([t,s]),S(!1)},[]),{getRootProps:F,getInputProps:T}=(0,eu.useDropzone)({onDrop:D,maxFiles:1,accept:{"image/*":[".jpeg",".jpg",".png"]}}),{getRootProps:V,getInputProps:O}=(0,eu.useDropzone)({onDrop:J,maxFiles:1,accept:{"image/*":[".jpeg",".jpg",".png"]}}),handleProfileImageDialogClose=()=>{b(!1)},handleHeroDialogClose=()=>{S(!1)};function handleSetupSubmit(e){"saveSettings"==e.nativeEvent.submitter.name?handleSaveSettings(e):"saveNewPassword"==e.nativeEvent.submitter.name?handleResetPassword(e):"yesDeleteAccount"==e.nativeEvent.submitter.name&&handleDeleteAccount(e)}async function handleSaveSettings(r){r.preventDefault();let n=new FormData(r.currentTarget),a=e.uid,o=n.get("name"),c=n.get("location"),d=n.get("phoneNumber");if(d&&(!r.currentTarget.reportValidity()||!d.match(/^(\+\d{1,2}\s?)?1?\-?\.?\s?\(?\d{3}\)?[\s.-]?\d{3}[\s.-]?\d{4}$/)))return l({...i,phoneNumber:{error:!0,message:"Your phone number is not formatted correctly."}}),!1;let p={name:o,location:c,phoneNumber:d};if(0!=h.length)try{let e=await (0,E.Ix)(a,h[0]);p.profileImage=e}catch(e){return console.error(e),u(e.message),!1}if(0!=g.length)try{let e=await (0,E.Ix)(a,g[0]);p.heroImage=e}catch(e){return console.error(e),u(e.message),!1}await (0,E.Nq)(a,p).then(()=>{w.push(`/profile/${a}`)}).catch(e=>{console.error(e),u(e.message)});let x={...e,...p};return t(x),s(0),!1}let[Z,$]=(0,n.useState)(!1),[W,z]=(0,n.useState)(!1),handleClosePopup1=()=>{$(!1)},handleClosePopup2=()=>{z(!1)},[G,Q]=(0,n.useState)(""),[ee,es]=(0,n.useState)(""),handleResetPassword=async e=>{e.preventDefault();let t=new FormData(e.currentTarget),s=t.get("newPassword");if(s&&(!e.currentTarget.reportValidity()||s.length<6))return es("Your password must be at least 6 characters long."),!1;let r=C();await (0,N.gQ)(r,s).then(()=>{handleClosePopup1()}).catch(e=>{console.error(e),es(e.message)})},handleDeleteAccount=async t=>{t.preventDefault();let s=e.uid,r=(0,M.JU)(B.db,"users",s,"private","contact"),n=(0,M.JU)(B.db,"users",s,"private","favorites"),i=(0,M.JU)(B.db,"users",s);await (0,M.oe)(r).catch(e=>{console.error(e),es(e.message)}),await (0,M.oe)(n).catch(e=>{console.error(e),es(e.message)}),await (0,M.oe)(i).catch(e=>{console.error(e),es(e.message)});let a=C();await a.delete(),w.push("/")};return(0,r.jsxs)("div",{style:{width:"100%",textAlign:"left",height:"100vh"},children:[(0,r.jsxs)("form",{onSubmit:handleSetupSubmit,style:{padding:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[c?r.jsx(d(),{severity:"error",children:c}):null,(0,r.jsxs)(x(),{container:!0,spacing:2,columnSpacing:8,alignItems:"center",justifyContent:"center",mt:3,children:[(0,r.jsxs)(x(),{item:!0,children:[r.jsx(a(),{align:"center",children:"Profile Picture"}),r.jsx(v(),{onClick:()=>{b(!0)},children:r.jsx(H(),{elevation:3,sx:{width:100,height:100,backgroundImage:`url(${h[1]})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative",borderRadius:"50%"},children:!h[1]&&r.jsx(m(),{alt:"Banner",sx:{width:100,height:100},variant:"circular",children:r.jsx(R.Z,{})})})})]}),(0,r.jsxs)(x(),{item:!0,children:[r.jsx(a(),{align:"center",children:"Banner Image"}),r.jsx(v(),{onClick:()=>{S(!0)},sx:{borderRadius:0},children:r.jsx(H(),{elevation:3,sx:{width:200,height:100,backgroundImage:`url(${g[1]})`,backgroundSize:"cover",backgroundPosition:"center",position:"relative"},children:!g[1]&&r.jsx(m(),{alt:"Banner",sx:{width:200,height:100},variant:"square",children:r.jsx(ed.Z,{})})})})]})]}),r.jsx("br",{}),(0,r.jsxs)("div",{style:{width:"30%"},children:[r.jsx(Y(),{margin:"dense",variant:"standard",id:"fname",name:"name",label:"Name",defaultValue:e.name,type:"text",required:!0,fullWidth:!0,inputProps:{maxLength:64}}),r.jsx("br",{}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option1"===P,onChange:handleChange1,value:"option1"}),label:"Show Email to Registered Users"})}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option2"===P,onChange:handleChange1,value:"option2"}),label:"Verified Students Only"})}),r.jsx("br",{}),r.jsx(Y(),{margin:"dense",variant:"standard",id:"location",name:"location",label:"Location",type:"text",defaultValue:e.location,fullWidth:!0,inputProps:{maxLength:64}}),r.jsx("br",{}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option1"===A,onChange:handleChange2,value:"option1"}),label:"Show Location to Registered Users"})}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option2"===A,onChange:handleChange2,value:"option2"}),label:"Verified Students Only"})}),r.jsx("br",{}),r.jsx(Y(),{margin:"dense",name:"phoneNumber",id:"phoneNumber",label:"Phone Number",defaultValue:e.phoneNumber,type:"tel",fullWidth:!0,error:i.phoneNumber?.error,helperText:i.phoneNumber?.message,variant:"standard",inputProps:{maxLength:16}}),r.jsx("br",{}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option1"===q,onChange:handleChange3,value:"option1"}),label:"Show Phone Number to Registered Users"})}),r.jsx(o(),{sx:{ml:2},children:r.jsx(X(),{control:r.jsx(K(),{checked:"option2"===q,onChange:handleChange3,value:"option2"}),label:"Verified Students Only"})}),r.jsx("br",{}),r.jsx("br",{}),r.jsx(et(),{type:"submit",name:"saveSettings",variant:"contained",color:"primary",sx:{color:"white"},fullWidth:!0,children:"Save Settings"}),(0,r.jsxs)(x(),{container:!0,spacing:3,justifyContent:"center",pt:6,children:[r.jsx(x(),{item:!0,xs:12,sm:6,md:6,lg:6,children:r.jsx(et(),{variant:"contained",onClick:()=>{$(!0)},name:"resetPassword",color:"error",sx:{color:"white"},fullWidth:!0,children:"Reset Password"})}),r.jsx(x(),{item:!0,xs:12,sm:6,md:6,lg:6,children:r.jsx(et(),{variant:"contained",onClick:()=>{z(!0)},name:"resetPassword",color:"error",sx:{color:"white"},fullWidth:!0,children:"Delete Account"})})]}),r.jsx("div",{children:r.jsx(er(),{open:Z,onClose:handleClosePopup1,children:r.jsx(ei(),{children:r.jsx(r.Fragment,{children:(0,r.jsxs)("form",{onSubmit:handleSetupSubmit,children:[r.jsx(Y(),{margin:"dense",variant:"standard",id:"newPassword",name:"newPassword",label:"New Password",type:"password",fullWidth:!0,required:!0,inputProps:{maxLength:64},value:G,onChange:e=>Q(e.target.value)}),r.jsx(o(),{mt:3}),r.jsx(et(),{type:"submit",name:"saveNewPassword",variant:"contained",color:"primary",sx:{color:"white"},fullWidth:!0,children:"Save New Password"}),ee&&r.jsx("div",{style:{color:"red"},children:ee})]})})})})}),r.jsx("div",{children:r.jsx(er(),{open:W,onClose:handleClosePopup2,children:r.jsx(ei(),{children:(0,r.jsxs)(r.Fragment,{children:[r.jsx(o(),{mt:6}),r.jsx("div",{children:(0,r.jsxs)(a(),{align:"center",children:["Are you sure you want to delete your account?",r.jsx("br",{}),"This action cannot be undone."]})}),r.jsx(o(),{mt:1}),(0,r.jsxs)(x(),{container:!0,spacing:3,justifyContent:"center",pt:6,children:[r.jsx(x(),{item:!0,xs:12,sm:6,md:6,lg:6,children:r.jsx(et(),{type:"submit",name:"yesDeleteAccount",variant:"contained",color:"primary",sx:{color:"white"},fullWidth:!0,onClick:handleDeleteAccount,children:"Yes"})}),r.jsx(x(),{item:!0,xs:12,sm:6,md:6,lg:6,children:r.jsx(et(),{type:"submit",name:"deleteAccount",variant:"contained",color:"error",sx:{color:"white"},fullWidth:!0,onClick:handleClosePopup2,children:"No"})})]})]})})})}),r.jsx("br",{})]})]}),(0,r.jsxs)(er(),{open:f,onClose:handleProfileImageDialogClose,"aria-labelledby":"responsive-dialog-title",children:[r.jsx(el(),{id:"responsive-dialog-title",children:"Upload Profile Image"}),r.jsx(ei(),{children:(0,r.jsxs)("div",{...F(),style:{border:"1px dashed gray",padding:"20px",cursor:"pointer"},children:[r.jsx("input",{...T()}),r.jsx(a(),{variant:"body1",children:"Drag & drop an image here, or click to select one"})]})}),r.jsx(ec(),{children:r.jsx(et(),{autoFocus:!0,onClick:handleProfileImageDialogClose,color:"primary",children:"Cancel"})})]}),(0,r.jsxs)(er(),{open:y,onClose:handleHeroDialogClose,"aria-labelledby":"responsive-dialog-title",children:[r.jsx(el(),{id:"responsive-dialog-title",children:"Upload Banner Image"}),r.jsx(ei(),{children:(0,r.jsxs)("div",{...V(),style:{border:"1px dashed gray",padding:"20px",cursor:"pointer"},children:[r.jsx("input",{...O()}),r.jsx(a(),{variant:"body1",children:"Drag & drop an image here, or click to select one"})]})}),r.jsx(ec(),{children:r.jsx(et(),{autoFocus:!0,onClick:handleHeroDialogClose,color:"primary",children:"Cancel"})})]})]})}function FavoriteListings({user:e}){let[t,s]=(0,n.useState)([]),[i,a]=(0,n.useState)(1),fetchListingsByIds=async e=>{let t=(0,M.IO)((0,M.hJ)(B.db,"listings"),(0,M.ar)((0,M.Jm)(),"in",e),(0,M.b9)(10)),s=await (0,M.PL)(t),r=[];return s.forEach(e=>{r.push({id:e.id,...e.data()})}),r};return(0,n.useEffect)(()=>{let fetchListings=async()=>{let t=e.favoriteListings,r=[];for(let e=0;e<t.length;e+=10)r.push(t.slice(e,Math.min(e+10,t.length)));let n=[];for(let e of r)await fetchListingsByIds(e).then(e=>{n.push(e)}).catch(e=>{console.error(e)});let i=n.flat();i.sort((e,t)=>t.createdAt.seconds-e.createdAt.seconds),s(i)};fetchListings()},[]),(0,r.jsxs)(o(),{px:3,py:2,children:[r.jsx(x(),{container:!0,spacing:2,children:t.slice((i-1)*10,10*i).map(e=>{let t=e.location.split(", "),s=t.length>2?`${t[1]}, ${t[2]}`:e.location;return r.jsx(x(),{item:!0,children:r.jsx($.Z,{listingId:e.id,title:e.title,createdAt:e.createdAt,updatedAt:e.updatedAt,description:e.description,images:e.images,location:s,price:e.price,studentVerification:e.studentVerification,priceHistory:e.priceHistory})},e.id)})}),r.jsx(b.default,{spacing:2,alignItems:"center",marginY:5,children:r.jsx(Z(),{count:Math.ceil(t.length/10),page:i,onChange:(e,t)=>{a(t)}})})]})}var eh=s(45003),ep=s.n(eh),ex=s(6176),eg=s.n(ex),em=s(43610),ej=s.n(em),ef=s(93429),eb=s.n(ef),ey=s(41857),ev=s.n(ey),eS=s(64832),ew=s.n(eS),eC=s(32122);let ProfileTabs_AdminPanel=()=>{let[e,t]=(0,n.useState)([]),[s,i]=(0,n.useState)([]),[a,l]=(0,n.useState)(null),[c,u]=(0,n.useState)(null),[p,g]=(0,n.useState)(!1),[m,j]=(0,n.useState)(1),[b,y]=(0,n.useState)(1),[S,w]=(0,n.useState)(!1),[C,P]=(0,n.useState)("success"),[k,A]=(0,n.useState)("");(0,n.useEffect)(()=>{let fetchUsersAndListings=async()=>{g(!0);try{let e=(0,M.hJ)(B.db,"users"),s=await (0,M.PL)(e),r=s.docs.map(e=>({id:e.id,...e.data()}));t(r);let n=(0,M.hJ)(B.db,"listings"),a=await (0,M.PL)(n),l=a.docs.map(e=>({id:e.id,...e.data()}));i(l)}catch(e){console.error("Error fetching data: ",e)}g(!1)};fetchUsersAndListings()},[]);let handleCloseAlert=(e,t)=>{"clickaway"!==t&&w(!1)},handleSearchUser=async()=>{g(!0);try{let e=(0,M.hJ)(B.db,"users"),s=(0,M.IO)(e,(0,M.ar)("name","==",a)),r=await (0,M.PL)(s);if(r.empty)console.log("No matching users.");else{let e=r.docs.map(e=>({id:e.id,...e.data()}));t(e)}}catch(e){console.error("Error searching users: ",e)}g(!1)},handleSearchListing=async()=>{g(!0);try{let e=(0,M.hJ)(B.db,"listings"),t=(0,M.IO)(e,(0,M.ar)("title","==",c)),s=await (0,M.PL)(t);if(s.empty)console.log("No matching listings.");else{let e=s.docs.map(e=>({id:e.id,...e.data()}));i(e)}}catch(e){console.error("Error searching listings: ",e)}g(!1)},handleDeleteListing=async e=>{try{let t=(0,M.JU)(B.db,"listings",e);await (0,M.oe)(t),w(!0),P("success"),A("Listing deleted successfully!")}catch(e){console.error("Error deleting listing: ",e),w(!0),P("error"),A("Failed to delete listing.")}};return p?r.jsx(h(),{}):(0,r.jsxs)(o(),{sx:{padding:"16px"},children:[(0,r.jsxs)(x(),{container:!0,spacing:2,children:[(0,r.jsxs)(x(),{item:!0,xs:12,md:6,children:[r.jsx(ep(),{options:e.map(e=>e.name),getOptionLabel:e=>e,value:a,onChange:(e,t)=>{l(t)},renderInput:e=>r.jsx(Y(),{...e,label:"Search User",margin:"normal"})}),r.jsx(et(),{startIcon:r.jsx(eC.Z,{}),onClick:handleSearchUser,children:"Search"}),r.jsx(eg(),{children:e.slice((m-1)*5,5*m).map(e=>(0,r.jsxs)(ej(),{children:[r.jsx(eb(),{primary:e.name}),r.jsx(ev(),{children:r.jsx(f(),{title:"Delete User",children:r.jsx(v(),{edge:"end",onClick:()=>handleDeleteListing(listing.id),children:r.jsx(F.Z,{})})})})]},e.id))}),r.jsx(Z(),{count:Math.ceil(e.length/5),page:m,onChange:(e,t)=>{j(t)}})]}),(0,r.jsxs)(x(),{item:!0,xs:12,md:6,children:[r.jsx(ep(),{options:s.map(e=>e.title),getOptionLabel:e=>e,value:c,onChange:(e,t)=>{u(t)},renderInput:e=>r.jsx(Y(),{...e,label:"Search Listing",margin:"normal"})}),r.jsx(et(),{startIcon:r.jsx(eC.Z,{}),onClick:handleSearchListing,children:"Search"}),r.jsx(eg(),{children:s.slice((b-1)*5,5*b).map(e=>(0,r.jsxs)(ej(),{children:[r.jsx(eb(),{primary:e.title}),r.jsx(ev(),{children:r.jsx(f(),{title:"Delete",children:r.jsx(v(),{edge:"end",onClick:()=>handleDeleteListing(e.id),children:r.jsx(F.Z,{})})})})]},e.id))}),r.jsx(Z(),{count:Math.ceil(s.length/5),page:b,onChange:(e,t)=>{y(t)}})]})]}),r.jsx(ew(),{open:S,autoHideDuration:6e3,onClose:handleCloseAlert,anchorOrigin:{vertical:"top",horizontal:"left"},children:r.jsx(d(),{onClose:handleCloseAlert,severity:C,sx:{width:"100%"},children:k})})]})},AdminBadge=()=>r.jsx(a(),{color:"error",component:"span",children:"(Admin)"});function Profile({params:e}){let[t,s]=(0,n.useState)({isAdmin:!1,isStudent:!1}),[i,l]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!0),[p,g]=(0,n.useState)(),[j,y]=(0,n.useState)(!1),[S,C]=(0,n.useState)(0),[k,I]=(0,n.useState)(null),[L,N]=(0,n.useState)("https://www.calpoly.edu/sites/calpoly.edu/files/inline-images/20210403-SpringScenics-JoeJ0020.jpg"),[O,Z]=(0,n.useState)(!1),[$,M]=(0,n.useState)(!1),{getUser:B,isLoggedIn:W,isAdmin:H}=(0,U.useAuth)(),z=(0,_.useRouter)();(0,n.useEffect)(()=>{if($){let e=setTimeout(()=>{z.push("/home")},5e3);return()=>clearTimeout(e)}},[$,z]);let Y=e.id;if((0,n.useEffect)(()=>{(0,E.PR)(Y).then(e=>{if(!e){s(e),u(!1);return}if(""==e.profileImage&&(e.profileImage=null),""==e.heroImage&&(e.heroImage=null),e.uid=Y,W()){let t=B();t.uid==Y?(l(!0),t.emailVerified&&"calpoly.edu"==t.email.split("@").pop()&&!e.isStudent&&fetch(`/api/verify/${Y}`,{method:"put"}).catch(e=>{console.error(e),g(e.message)})):H().then(e=>{e&&l(!0)}).catch(e=>{console.error(e),g(e.message)})}let checkAdminStatus=async()=>{let e=await H();y(e)};W()&&checkAdminStatus(),s(e),u(!1)}).catch(e=>{console.error(e),g(e.message)})},[W,H]),!c){if(!t)return r.jsx(o(),{sx:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",border:"2px solid #ff0000",borderRadius:"8px",backgroundColor:"#ffeeee"},children:r.jsx(a(),{variant:"h6",color:"error",margin:30,children:"User not found!"})});if(""==t.name){if(i){z.push("/setup");return}return r.jsx(o(),{sx:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",border:"2px solid #ff0000",borderRadius:"8px",backgroundColor:"#ffeeee"},children:r.jsx(a(),{variant:"h6",color:"error",margin:30,children:"User has not set up their page yet!"})})}}return $?(0,r.jsxs)(o(),{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx(a(),{variant:"h4",gutterBottom:!0,children:"You are now logged in!"}),r.jsx(a(),{children:"You will be redirected to the home screen in 5 seconds..."})]}):(0,r.jsxs)(o(),{sx:{height:"100vh",display:"flex",flexDirection:"column",alignItems:"center"},children:[!c&&r.jsx(o(),{sx:{width:"100%",height:300,backgroundImage:t.heroImage?`url(${t.heroImage})`:"url(https://www.calpoly.edu/sites/calpoly.edu/files/inline-images/20210403-SpringScenics-JoeJ0020.jpg)",backgroundSize:"cover",backgroundPosition:"center",position:"relative"}}),p&&r.jsx(d(),{severity:"error",children:p}),c?r.jsx(h(),{sx:{height:"100vh"}}):(0,r.jsxs)(x(),{container:!0,spacing:2,alignItems:"center",justifyContent:"center",mt:3,children:[r.jsx(x(),{item:!0,children:r.jsx(m(),{alt:"Profile Picture",src:t.profileImage,sx:{width:80,height:80},children:r.jsx(R.Z,{})})}),(0,r.jsxs)(x(),{item:!0,children:[(0,r.jsxs)(a(),{variant:"h4",gutterBottom:!0,children:[t.name,t.isVerified&&r.jsx(f(),{title:"The user is a verified student.",children:r.jsx(V.Z,{color:"primary"})}),t.isAdmin&&r.jsx(AdminBadge,{})," "]}),(0,r.jsxs)(b.default,{direction:"row",children:[r.jsx(a(),{variant:"subtitle1",children:"Seller"}),r.jsx(f(),{title:"User is a student",children:r.jsx(o(),{pl:1,children:t.isStudent&&r.jsx(J.Z,{})})})]})]}),(t.email||t.phoneNumber||t.location)&&r.jsx(x(),{item:!0,children:r.jsx(x(),{container:!0,pl:2,children:(0,r.jsxs)(x(),{item:!0,children:[r.jsx(a(),{variant:"body1",children:t.email}),r.jsx(a(),{variant:"body1",children:t.phoneNumber}),r.jsx(a(),{variant:"body1",children:t.location})]})})}),(0,r.jsxs)(x(),{item:!0,xs:12,sm:"auto",children:[r.jsx(v(),{"aria-label":"User Actions",onClick:e=>{I(e.currentTarget)},children:r.jsx(T.Z,{})}),r.jsx(w(),{id:"long-menu",anchorEl:k,open:!!k,onClose:()=>{I(null)},children:r.jsx(r.Fragment,{children:(0,r.jsxs)(P(),{onClick:()=>handleUserActions("delete"),sx:{color:"red"},children:[r.jsx(F.Z,{})," Delete Account"]})})})]})]}),r.jsx(A(),{sx:{my:2,width:"100%"}}),(0,r.jsxs)(q(),{value:S,onChange:(e,t)=>{C(t)},centered:!0,children:[r.jsx(D(),{label:"Listings"}),i&&r.jsx(D(),{label:"Settings"}),i&&r.jsx(D(),{label:"Favorites"}),i&&r.jsx(D(),{label:"Purchase History"}),i&&t.isAdmin&&r.jsx(D(),{label:"Admin Panel"})," "]}),0===S&&!c&&r.jsx(MyListings,{user:t}),1===S&&!c&&i&&r.jsx(Settings,{user:t,setUser:s,setCurrentTab:C}),2===S&&!c&&i&&r.jsx(FavoriteListings,{user:t}),3===S&&!c&&i&&r.jsx("div",{children:"Not implemented yet"}),4===S&&!c&&t.isAdmin&&r.jsx(ProfileTabs_AdminPanel,{user:t})," "]})}},93222:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>i,default:()=>o});var r=s(95153);let n=(0,r.createProxy)(String.raw`/Users/jlau/Code-2023/cpmarketplace/src/app/profile/[id]/page.js`),{__esModule:i,$$typeof:a}=n,l=n.default,o=l}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[657,6120,8153,1323,4359,3234,2870,2133,5915,2653,7791,9360,9175,1895,9781,9032,402,2291,436],()=>__webpack_exec__(66662));module.exports=s})();