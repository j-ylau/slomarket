(()=>{var e={};e.id=9834,e.ids=[9834],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},50852:e=>{"use strict";e.exports=require("async_hooks")},14300:e=>{"use strict";e.exports=require("buffer")},96206:e=>{"use strict";e.exports=require("console")},6113:e=>{"use strict";e.exports=require("crypto")},67643:e=>{"use strict";e.exports=require("diagnostics_channel")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},15673:e=>{"use strict";e.exports=require("node:events")},84492:e=>{"use strict";e.exports=require("node:stream")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},4074:e=>{"use strict";e.exports=require("perf_hooks")},77282:e=>{"use strict";e.exports=require("process")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},35356:e=>{"use strict";e.exports=require("stream/web")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},29830:e=>{"use strict";e.exports=require("util/types")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},48128:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>x,tree:()=>c});var s=r(67096),i=r(16132),n=r(37284),o=r.n(n),a=r(32564),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let c=["",{children:["listing",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,76249)),"/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,96109)),"/Users/jlau/Code-2023/cpmarketplace/src/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js"],d="/listing/[id]/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/listing/[id]/page",pathname:"/listing/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},16666:(e,t,r)=>{Promise.resolve().then(r.bind(r,30375))},30375:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var s=r(30784),i=r(57114),n=r(9885),o=r(21971),a=r.n(o),l=r(99360),c=r.n(l),u=r(33987),d=r.n(u),p=r(43872),x=r.n(p),h=r(52694),g=r.n(h),m=r(76267),f=r.n(m),v=r(1853),_=r.n(v),q=r(16614),y=r.n(q),j=r(62969),b=r.n(j),P=r(42153),S=r.n(P),w=r(16856),E=r.n(w),k=r(95915),C=r.n(k),L=r(76151),A=r(61522);r(87344);var U=r(18282),I=r(96106);let __WEBPACK_DEFAULT_EXPORT__=()=>{let e=(0,i.useRouter)(),{id:t}=(0,i.useParams)(),[r,o]=(0,n.useState)(null),[l,u]=(0,n.useState)(!0),[p,h]=(0,n.useState)(""),[m,v]=(0,n.useState)(null),[q,j]=(0,n.useState)(!1),[P,w]=(0,n.useState)(!0),[k,B]=(0,n.useState)(!1),[M,T]=(0,n.useState)(!1),[G,F]=(0,n.useState)(!1),[R,$]=(0,n.useState)(!1),[J,O]=(0,n.useState)(null),[W,N]=(0,n.useState)({isAdmin:!1,isStudent:!1}),{getUser:V,isLoggedIn:X,isAdmin:D}=(0,U.useAuth)(),[K,Q]=(0,n.useState)(0);(0,n.useEffect)(()=>{if(t){let fetchListing=async()=>{u(!0);try{let e=(0,A.JU)(L.db,"listings",t),r=await (0,A.QT)(e);r.exists()?o({id:r.id,...r.data()}):h("Listing not found")}catch(e){h("An error occurred while fetching the listing"),console.error(e)}finally{u(!1)}};fetchListing()}},[t]),(0,n.useEffect)(()=>{let fetchSellerInfo=async()=>{if(r&&r.sellerId)try{let e=(0,A.JU)(L.db,"users",r.sellerId,"private","contact"),t=await (0,A.QT)(e);if(t.exists()){let e=t.data();v({email:e.email,phoneNumber:e.phoneNumber,location:e.location})}else console.error("Seller contact information not found")}catch(e){console.error("Error fetching seller contact information:",e)}};r&&fetchSellerInfo()},[r]),(0,n.useEffect)(()=>{X();let e=V();console.log(e),null==e?console.log("user not logged in"):(F(!0),(0,I.PR)(e.uid).then(r=>{if(!r){N(r),w(!1);return}if(""==r.profileImage&&(r.profileImage=null),""==r.heroImage&&(r.heroImage=null),r.uid=e.uid,X()){let t=V();t.uid==e.uid?(j(!0),t.emailVerified&&"calpoly.edu"==t.email.split("@").pop()&&!r.isStudent&&fetch(`/api/verify/${e.uid}`,{method:"put"}).catch(e=>{console.error(e),setErrorMessage(e.message)})):D().then(e=>{e&&j(!0)}).catch(e=>{console.error(e),setErrorMessage(e.message)})}let checkAdminStatus=async()=>{let e=await D();B(e)};X()&&checkAdminStatus(),N(r),w(!1),console.log(r),r.favoriteListings.includes(t)&&T(!0)}).catch(e=>{console.error(e),setErrorMessage(e.message)}))},[X,D]);let handleFavorite=async()=>{console.log(W),W.favoriteListings.push(t);let e=(0,A.JU)(L.db,"users",W.uid,"private","favorites");await (0,A.r7)(e,{favoriteListings:W.favoriteListings}),T(!0)},handleUnfavorite=async()=>{console.log(W);let e=W.favoriteListings.indexOf(t);W.favoriteListings.splice(e);let r=(0,A.JU)(L.db,"users",W.uid,"private","favorites");await (0,A.r7)(r,{favoriteListings:W.favoriteListings}),T(!1)};return l?s.jsx(a(),{container:!0,justifyContent:"center",alignItems:"center",style:{height:"100vh"},children:s.jsx(c(),{})}):p?s.jsx(d(),{variant:"h6",color:"error",textAlign:"center",children:p}):r?(0,s.jsxs)(x(),{sx:{padding:30},children:[(0,s.jsxs)(g(),{elevation:3,sx:{mt:2,p:2},children:[s.jsx(d(),{variant:"h4",gutterBottom:!0,children:r.title}),s.jsx(d(),{variant:"body1",gutterBottom:!0,children:r.description}),(0,s.jsxs)(d(),{variant:"h6",gutterBottom:!0,children:["Price: $",r.price]}),(0,s.jsxs)(d(),{variant:"body2",color:"textSecondary",gutterBottom:!0,children:["Location: ",r.location]}),m&&s.jsx(f(),{sx:{maxWidth:345,cursor:"pointer"},onClick:()=>e.push(`/profile/${r.sellerId}`),children:(0,s.jsxs)(_(),{children:[s.jsx(d(),{gutterBottom:!0,variant:"h5",component:"div",children:"Contact Seller"}),(0,s.jsxs)(d(),{variant:"body2",color:"text.secondary",children:["Email: ",m.email]}),(0,s.jsxs)(d(),{variant:"body2",color:"text.secondary",children:["Phone: ",m.phoneNumber]}),(0,s.jsxs)(d(),{variant:"body2",color:"text.secondary",children:["Location: ",m.location]})]})}),(0,s.jsxs)(x(),{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[!M&&G&&s.jsx(y(),{variant:"contained",onClick:handleFavorite,children:"Favorite"}),M&&G&&s.jsx(y(),{variant:"contained",onClick:handleUnfavorite,children:"Unfavorite"})]})]}),(0,s.jsxs)(b(),{open:R,onClose:()=>$(!1),"aria-labelledby":"image-dialog-title",maxWidth:"md",children:[s.jsx(S(),{id:"image-dialog-title",children:"Image View"}),s.jsx(E(),{children:s.jsx("img",{src:J,alt:"Enlarged View",style:{width:"100%",height:"auto"}})}),s.jsx(C(),{children:s.jsx(y(),{variant:"contained",onClick:()=>$(!1),children:"Close"})})]})]}):null}},76249:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>n,default:()=>l});var s=r(95153);let i=(0,s.createProxy)(String.raw`/Users/jlau/Code-2023/cpmarketplace/src/app/listing/[id]/page.js`),{__esModule:n,$$typeof:o}=i,a=i.default,l=a}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[657,6120,8153,1323,3234,5915,9360,5873,7344,402,2291],()=>__webpack_exec__(48128));module.exports=r})();