"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{148:function(e,t,n){n.d(t,{I8:function(){return l},db:function(){return c},tO:function(){return d}});var i=n(994);n(5073);var r=n(4086),s=n(9584),o=n(8153);let a=(0,i.ZF)({apiKey:"AIzaSyBjEHdFQZFsfN-RGa59n16XO7qQ4dhFsAo",authDomain:"slomarket-ebbd9.firebaseapp.com",projectId:"slomarket-ebbd9",storageBucket:"slomarket-ebbd9.appspot.com",messagingSenderId:"247606192779",appId:"1:247606192779:web:421bdc33c388c5c8e828e",measurementId:"G-E3DPKJ6L5V"}),l=(0,o.v0)(a),c=(0,r.ad)(a),d=(0,s.cF)(a)},5959:function(e,t,n){n.r(t),n.d(t,{default:function(){return AuthProvider},useAuth:function(){return useAuth}});var i=n(7437),r=n(2265),s=n(148),o=n(8153);let a=(0,r.createContext)();function useAuth(){return(0,r.useContext)(a)}function AuthProvider(e){let{children:t}=e,[n,l]=(0,r.useState)(),[c,d]=(0,r.useState)(!0);async function isAdmin(){return await s.I8.currentUser.getIdTokenResult().then(e=>!!e.claims.admin).catch(e=>{throw e})}return(0,r.useEffect)(()=>{let e=s.I8.onAuthStateChanged(e=>{l(e),d(!1)},e=>{console.error("Authentication error:",e),d(!1)});return e},[]),(0,i.jsx)(a.Provider,{value:{currentUser:n,getUser:function(){return s.I8.currentUser},isLoggedIn:function(){return null!==s.I8.currentUser},isAdmin,login:function(e,t){return s.I8.signInWithEmailAndPassword(e,t)},signOut:function(){return s.I8.signOut()},signUp:function(e,t){return(0,o.Xb)(s.I8,e,t)}},children:!c&&t})}},4165:function(e,t,n){var i=n(7437),r=n(2265),s=n(4033),o=n(1101),a=n(2135),l=n(9245),c=n(1898),d=n(3226),u=n(3457),h=n(7827),x=n(4236),p=n(9394),g=n(1797),f=n(6337),m=n(4173),j=n(7292),Z=n(7070),b=n(5037),w=n(4510),v=n(4565),y=n(2390),C=n.n(y),k=n(2067),I=n.n(k),S=n(4086),A=n(2653),D=n(148),U=n(3932),E=n(1417),F=n(4856),L=n(6446),z=n(4273),O=n(7175),R=n(5959);t.Z=function(e){let{loading:t,listingId:n,title:y,createdAt:k,updatedAt:N,description:P,images:Y,isFree:M,location:B,price:G,studentVerification:H,priceHistory:_}=e,[T,W]=(0,r.useState)(!1),J=(0,o.Z)(),K=(0,a.Z)(J.breakpoints.down("sm")),[Q,X]=(0,r.useState)(null),[q,V]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(""),et=(0,s.useRouter)(),{isLoggedIn:en,isAdmin:ei}=(0,R.useAuth)(),er=(0,R.useAuth)();console.log(er.currentUser);let handleSnackbarClose=(e,t)=>{"clickaway"!==t&&V(!1)},handleCloseMenu=()=>{X(null)},handleDeleteListing=async e=>{if(!ei){ee("You do not have permission to delete this listing. Contact support if you think this is an issue."),V(!0);return}try{let t=(0,S.JU)(D.db,"listings",e);await (0,S.oe)(t),ee("Listing deleted successfully."),V(!0)}catch(e){console.error("Error deleting listing: ",e),ee("You do not have permission to delete listings. Contact support@slomarket.com if you think this is an issue."),V(!0)}},es=Array.isArray(Y)&&Y.length>0?Y[0]:"default-image-url",formatDate=e=>{if(!e||!e.seconds)return"Unknown";let t=new Date(1e3*e.seconds),n=I()(t).format("MM/DD/YYYY");return"Invalid date"!==n?n:"Unknown"};return t?(0,i.jsxs)(l.Z,{sx:{width:K?"100%":300,minHeight:"420px",borderRadius:"8px",overflow:"hidden",boxShadow:"0px 0px 4px rgba(0, 0, 0, 0.25)",marginBottom:2,flexDirection:"column",display:"flex"},children:[(0,i.jsx)(c.Z,{variant:"rectangular",width:"100%",height:118}),(0,i.jsxs)(l.Z,{sx:{p:2},children:[(0,i.jsx)(c.Z,{variant:"text",width:"60%"}),(0,i.jsx)(c.Z,{variant:"text"}),(0,i.jsx)(c.Z,{variant:"text"}),(0,i.jsx)(c.Z,{variant:"text",width:"80%"})]}),(0,i.jsxs)(l.Z,{sx:{p:2,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(c.Z,{variant:"text",width:"40%"}),(0,i.jsx)(c.Z,{variant:"circular",width:40,height:40})]})]}):(0,i.jsxs)(l.Z,{sx:{width:K?"100%":300,height:"460px",borderRadius:"8px",overflow:"hidden",boxShadow:"0px 0px 4px rgba(0, 0, 0, 0.25)",marginBottom:2,flexDirection:"column",display:"flex",backgroundColor:"white"},children:[(0,i.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",backgroundColor:"white"},children:[(0,i.jsx)(A.Z,{"aria-label":"settings","aria-controls":"long-menu","aria-haspopup":"true",onClick:e=>{X(e.currentTarget)},sx:{margin:"0 8px"},children:(0,i.jsx)(F.Z,{})}),(0,i.jsxs)(U.Z,{id:"long-menu",anchorEl:Q,open:!!Q,onClose:handleCloseMenu,children:[(0,i.jsxs)(E.Z,{onClick:()=>{C()(n),ee("Listing ID copied to clipboard."),V(!0),handleCloseMenu()},children:[(0,i.jsx)(O.Z,{fontSize:"small",sx:{marginRight:1}})," Copy Listing ID"]}),en&&ei&&(0,i.jsxs)(E.Z,{onClick:()=>handleDeleteListing(n),sx:{color:z.Z[500]},children:[(0,i.jsx)(L.Z,{fontSize:"small",sx:{marginRight:1}})," Delete Listing"]})]})]}),(0,i.jsxs)(l.Z,{sx:{flexGrow:1,cursor:"pointer"},onClick:()=>{et.push("/listing/".concat(n))},children:[(0,i.jsx)(l.Z,{sx:{width:"100%",position:"relative",paddingTop:"56.25%"},children:(0,i.jsx)("img",{src:es,alt:y,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"}})}),(0,i.jsxs)(l.Z,{sx:{p:2,flexGrow:1},style:{backgroundColor:"white"},children:[(0,i.jsx)(d.Z,{variant:"h6",sx:{fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y}),(0,i.jsx)(d.Z,{variant:"subtitle2",color:"textSecondary",sx:{mb:1},children:P}),(0,i.jsx)(d.Z,{variant:"body2",color:"textSecondary",sx:{fontStyle:"italic"},children:"Created: ".concat(formatDate(k)||"Not available")}),N&&(0,i.jsx)(d.Z,{variant:"caption",color:"textSecondary"})]}),(0,i.jsxs)(u.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{p:2,backgroundColor:"white"},children:[(0,i.jsx)(d.Z,{variant:"h5",sx:{fontWeight:"bold",display:"flex",alignItems:"center"},children:0===G?(0,i.jsx)(h.Z,{icon:(0,i.jsx)(v.Z,{}),label:"Free",size:"large"}):"$".concat(Number(G).toFixed(2))}),H&&(0,i.jsxs)(x.Z,{badgeContent:(0,i.jsx)(w.Z,{color:"primary"}),sx:{mr:4},anchorOrigin:{vertical:"top",horizontal:"right"},children:[(0,i.jsx)(l.Z,{})," "]})]}),(0,i.jsxs)(l.Z,{sx:{p:2,display:"flex",alignItems:"center",backgroundColor:"white"},children:[(0,i.jsx)(b.Z,{fontSize:"small",color:"primary"}),(0,i.jsx)(d.Z,{variant:"caption",color:"textSecondary",sx:{ml:1},children:B})]})]}),(0,i.jsxs)(p.Z,{open:T,onClose:()=>{W(!1)},children:[(0,i.jsx)(g.Z,{children:"Price History"}),(0,i.jsx)(f.Z,{children:(0,i.jsx)(m.Z,{children:Array.isArray(_)?_.map(e=>"".concat(e.price," on ").concat(formatDate(e.date))).join("\n"):"No price history available"})})]}),(0,i.jsx)(j.Z,{open:q,autoHideDuration:6e3,onClose:handleSnackbarClose,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:(0,i.jsx)(Z.Z,{onClose:handleSnackbarClose,severity:"success",sx:{width:"100%"},children:$})})]})}}}]);